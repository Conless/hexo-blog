---
title: 数据结构（三）：堆与 STL priority_queue
date: 2023/02/21 11:32:00
categories:
- [Computer Science, Data Structure (CS1951@SJTU)]
---
# 堆
## 简介
相较于平衡树等，堆是一种约束较为自由的数据结构，只需要满足父节点的键值大于/小于子节点即可。
## 二叉堆
下面讲解以二叉堆方式实现的大根堆，它是一棵完全二叉树，其保持平衡的基本方式是向上调整（子节点与父节点交换）与向下调整。
### 插入
在插入时，将新的节点插入到完全二叉树的最后一个位置，然后不断向上调整；
### 删除
在删除根节点时，将其与最后一个节点交换，将其删除，然后将新的根节点不断向下调整。
### 建树
假设直接按照顺序构建出一棵完全二叉树，然后对其调整使得满足堆的性质，有两种方案：
1. 从根开始，不断向上调整，这样在越深处越多节点，走的距离期望越长，总的复杂度期望为 $O(n\log n)$。
2. 从叶子节点开始，不断向下调整，这样在越深处越多节点，但走的距离期望短，总的复杂度期望为 $O(n)$。
   
因此，采取第二种方案更加合理。
### 应用
对顶堆：一个小根堆与一个大根堆结合，共同维护序列的第 $k$ 大数。

## 左偏树
左偏树是一种可并堆。它是一棵具有“左偏”性质的二叉树。
### 左偏性
dist：一个节点到子节点中外节点的最短距离，其中外节点指没有左儿子或没有右儿子的节点。
左偏性：若一棵二叉树中任意节点左儿子的 dist 大于右儿子的 dist，称其具有左偏性。